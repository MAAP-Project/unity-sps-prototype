# terraform-unity-sps-hysds-cluster

<!-- BEGINNING OF PRE-COMMIT-TERRAFORM DOCS HOOK -->

## Requirements

No requirements.

## Providers

| Name                                                                  | Version |
| --------------------------------------------------------------------- | ------- |
| <a name="provider_aws"></a> [aws](#provider_aws)                      | 4.22.0  |
| <a name="provider_helm"></a> [helm](#provider_helm)                   | 2.6.0   |
| <a name="provider_kubernetes"></a> [kubernetes](#provider_kubernetes) | 2.12.1  |

## Modules

No modules.

## Resources

| Name                                                                                                                                                                       | Type     |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- |
| [aws_s3_bucket.s3_bucket](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket)                                                           | resource |
| [aws_s3_bucket_acl.s3_bucket_acl](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_acl)                                               | resource |
| [aws_s3_object.source_files](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_object)                                                        | resource |
| [helm_release.grq2-es](https://registry.terraform.io/providers/hashicorp/helm/latest/docs/resources/release)                                                               | resource |
| [helm_release.mozart-es](https://registry.terraform.io/providers/hashicorp/helm/latest/docs/resources/release)                                                             | resource |
| [kubernetes_config_map.aws-credentials](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                                     | resource |
| [kubernetes_config_map.celeryconfig](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                                        | resource |
| [kubernetes_config_map.cwl-workflow-utils](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                                  | resource |
| [kubernetes_config_map.cwl-workflows](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                                       | resource |
| [kubernetes_config_map.datasets](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                                            | resource |
| [kubernetes_config_map.grq2-settings](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                                       | resource |
| [kubernetes_config_map.logstash-configs](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                                    | resource |
| [kubernetes_config_map.mozart-settings](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                                     | resource |
| [kubernetes_config_map.netrc](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                                               | resource |
| [kubernetes_config_map.sounder-sips-static-data](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                            | resource |
| [kubernetes_config_map.supervisord-job-worker](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                              | resource |
| [kubernetes_config_map.supervisord-orchestrator](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                            | resource |
| [kubernetes_config_map.supervisord-user-rules](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                              | resource |
| [kubernetes_config_map.supervisord-verdi](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map)                                   | resource |
| [kubernetes_deployment.ades-wpst-api](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                       | resource |
| [kubernetes_deployment.factotum-job-worker](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                 | resource |
| [kubernetes_deployment.grq2](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                                | resource |
| [kubernetes_deployment.hysds-ui](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                            | resource |
| [kubernetes_deployment.logstash](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                            | resource |
| [kubernetes_deployment.minio](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                               | resource |
| [kubernetes_deployment.mozart](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                              | resource |
| [kubernetes_deployment.orchestrator](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                        | resource |
| [kubernetes_deployment.redis](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                               | resource |
| [kubernetes_deployment.user-rules](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                          | resource |
| [kubernetes_deployment.verdi](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment)                                               | resource |
| [kubernetes_job.mc](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/job)                                                                | resource |
| [kubernetes_namespace.unity-sps](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/namespace)                                             | resource |
| [kubernetes_persistent_volume_claim.ades-wpst-sqlite-pv-claim](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/persistent_volume_claim) | resource |
| [kubernetes_persistent_volume_claim.minio-pv-claim](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/persistent_volume_claim)            | resource |
| [kubernetes_service.ades-wpst-api-service](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service)                                     | resource |
| [kubernetes_service.grq2_service](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service)                                              | resource |
| [kubernetes_service.hysds-ui-service](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service)                                          | resource |
| [kubernetes_service.minio-service](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service)                                             | resource |
| [kubernetes_service.mozart-service](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service)                                            | resource |
| [kubernetes_service.rabbitmq-mgmt-service](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service)                                     | resource |
| [kubernetes_service.rabbitmq-service](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service)                                          | resource |
| [kubernetes_service.redis_service](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service)                                             | resource |
| [kubernetes_stateful_set.rabbitmq_statefulset](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/stateful_set)                            | resource |

## Inputs

| Name                                                                                                | Description                                                    | Type                                                                                                   | Default                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Required |
| --------------------------------------------------------------------------------------------------- | -------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------: |
| <a name="input_celeryconfig_filename"></a> [celeryconfig_filename](#input_celeryconfig_filename)    | n/a                                                            | `string`                                                                                               | `"celeryconfig_remote.py"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_datasets_filename"></a> [datasets_filename](#input_datasets_filename)                | n/a                                                            | `string`                                                                                               | `"datasets.remote.template.json"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |    no    |
| <a name="input_deployment_environment"></a> [deployment_environment](#input_deployment_environment) | n/a                                                            | `string`                                                                                               | `"mcp"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |    no    |
| <a name="input_docker_images"></a> [docker_images](#input_docker_images)                            | n/a                                                            | `map(string)`                                                                                          | <pre>{<br> "ades_wpst_api": "ghcr.io/unity-sds/unity-sps-prototype/ades-wpst-api:unity-v0.0.1",<br> "busybox": "k8s.gcr.io/busybox",<br> "hysds_core": "ghcr.io/unity-sds/unity-sps-prototype/hysds-core:unity-v0.0.1",<br> "hysds_factotum": "ghcr.io/unity-sds/unity-sps-prototype/hysds-factotum:unity-v0.0.1",<br> "hysds_grq2": "ghcr.io/unity-sds/unity-sps-prototype/hysds-grq2:unity-v0.0.1",<br> "hysds_mozart": "ghcr.io/unity-sds/unity-sps-prototype/hysds-mozart:unity-v0.0.1",<br> "hysds_ui": "ghcr.io/unity-sds/unity-sps-prototype/hysds-ui-remote:unity-v0.0.1",<br> "hysds_verdi": "ghcr.io/unity-sds/unity-sps-prototype/hysds-verdi:unity-v0.0.1",<br> "logstash": "docker.elastic.co/logstash/logstash:7.10.2",<br> "mc": "minio/mc:RELEASE.2022-03-13T22-34-00Z",<br> "minio": "minio/minio:RELEASE.2022-03-17T06-34-49Z",<br> "rabbitmq": "rabbitmq:3-management",<br> "redis": "redis:latest"<br>}</pre> |    no    |
| <a name="input_grq2_es"></a> [grq2_es](#input_grq2_es)                                              | n/a                                                            | <pre>object({<br> volume_claim_template = object({<br> storage_class_name = string<br> })<br> })</pre> | <pre>{<br> "volume_claim_template": {<br> "storage_class_name": "gp2-sps"<br> }<br>}</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_kubeconfig_filepath"></a> [kubeconfig_filepath](#input_kubeconfig_filepath)          | Path to the kubeconfig file for the Kubernetes cluster         | `string`                                                                                               | n/a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |   yes    |
| <a name="input_mozart_es"></a> [mozart_es](#input_mozart_es)                                        | n/a                                                            | <pre>object({<br> volume_claim_template = object({<br> storage_class_name = string<br> })<br> })</pre> | <pre>{<br> "volume_claim_template": {<br> "storage_class_name": "gp2-sps"<br> }<br>}</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_namespace"></a> [namespace](#input_namespace)                                        | Namespace for the Unity SPS HySDS-related Kubernetes resources | `string`                                                                                               | `"unity-sps"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |    no    |
| <a name="input_node_port_map"></a> [node_port_map](#input_node_port_map)                            | n/a                                                            | `map(number)`                                                                                          | <pre>{<br> "ades_wpst_api_service": 30011,<br> "grq2_es": 30012,<br> "grq2_service": 30002,<br> "hysds_ui_service": 30009,<br> "minio_service_api": 30007,<br> "minio_service_interface": 30008,<br> "mozart_es": 30013,<br> "mozart_service": 30001,<br> "rabbitmq_mgmt_service_cluster_rpc": 30003,<br> "rabbitmq_service_cluster_rpc": 30006,<br> "rabbitmq_service_epmd": 30004,<br> "rabbitmq_service_listener": 30005,<br> "redis_service": 30010<br>}</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                |    no    |
| <a name="input_service_type"></a> [service_type](#input_service_type)                               | n/a                                                            | `string`                                                                                               | `"LoadBalancer"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |    no    |

## Outputs

| Name                                                                                                                                            | Description                                                                                                                                                                               |
| ----------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <a name="output_ades-wpst-api-load-balancer-hostname"></a> [ades-wpst-api-load-balancer-hostname](#output_ades-wpst-api-load-balancer-hostname) | n/a                                                                                                                                                                                       |
| <a name="output_grq-load-balancer-hostname"></a> [grq-load-balancer-hostname](#output_grq-load-balancer-hostname)                               | https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/data-sources/ingress https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/routing-to-elb-load-balancer.html |
| <a name="output_hysds-ui-load-balancer-hostname"></a> [hysds-ui-load-balancer-hostname](#output_hysds-ui-load-balancer-hostname)                | n/a                                                                                                                                                                                       |
| <a name="output_minio-load-balancer-hostname"></a> [minio-load-balancer-hostname](#output_minio-load-balancer-hostname)                         | n/a                                                                                                                                                                                       |
| <a name="output_mozart-load-balancer-hostname"></a> [mozart-load-balancer-hostname](#output_mozart-load-balancer-hostname)                      | n/a                                                                                                                                                                                       |
| <a name="output_rabbitmq-load-balancer-hostname"></a> [rabbitmq-load-balancer-hostname](#output_rabbitmq-load-balancer-hostname)                | n/a                                                                                                                                                                                       |
| <a name="output_rabbitmq-mgmt-load-balancer-hostname"></a> [rabbitmq-mgmt-load-balancer-hostname](#output_rabbitmq-mgmt-load-balancer-hostname) | n/a                                                                                                                                                                                       |
| <a name="output_redis-load-balancer-hostname"></a> [redis-load-balancer-hostname](#output_redis-load-balancer-hostname)                         | n/a                                                                                                                                                                                       |

<!-- END OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
